<!DOCTYPE html>
<html>
	<head>
	    	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<meta http-equiv="Cache-Control" content="max-age=2592000">
<title>もっとスマートを | Coelacanth&#39;s Dream</title>
	<meta name="description" content="おこなったCSSの最適化の詳細とその他更新履歴。 以前はテキストすべてに text-shadow を適用していたが、 影の計算というのはコストをかかるもので、このことが原因か、 「初回入力遅延の最大推定時間」が200〜30... " />
	<base href="https://umio-yasuno.github.io/posts/2019/11/25/more-smart/"><meta name="url" content="https://umio-yasuno.github.io/posts/2019/11/25/more-smart/" />
	<meta name="author" content="Umio Yasuno" />
	<meta name="keywords" content=" Hugo, Theme" />
	<meta name="referrer" content="no-referrer" />
	<meta name="format-detection" content="telephone=no, address=no, email=no">

	<meta property="og:locale" content="ja">

	<link rel="preload" href="https://umio-yasuno.github.io/css/lain.min.css" as="style" importance="high">
	<link rel="preload" href="https://umio-yasuno.github.io/css/animation.min.css" as="style" importance="high">
		<link rel="stylesheet" href="https://umio-yasuno.github.io/css/lain.min.css">
		<link rel="stylesheet" href="https://umio-yasuno.github.io/css/animation.min.css">
		<link rel="icon" href="https://umio-yasuno.github.io/favicon.ico">
	</head>
    <body>
	<main>
		<article class="text">
			<br>
			<header>	<span class="title">
		<a href="https://umio-yasuno.github.io/">Coelacanth&#39;s Dream</a>
	</span>
</header>
			<br>
		<h2><span class="page-title">もっとスマートを </span></h2>
			<p>おこなったCSSの最適化の詳細とその他更新履歴。</p>

<p>以前はテキストすべてに text-shadow を適用していたが、<br />
影の計算というのはコストをかかるもので、このことが原因か、<br />
「初回入力遅延の最大推定時間」が200〜300ms近くのひどいものになっていた。</p>

<p>そこで text-shadow をページタイトルのみに適用することにした。<br />
ブラウン管らしさは減ってしまったが、減り具合に対して使いやすさはぐんと向上してるのだから、<br />
効率はいいため文句なしだ。<br />
それに色やブラーの加減といった調節が面倒だったため、性能の問題がなくとも遅かれ早かれ減らしていただろう。</p>

<p>そして一部要素に transform を追加。<br />
聞いた所によると、これでブラウザ側がその要素をGPUレイヤーとして認識、処理してくれるとか。</p>

<pre><code>transform: translateZ(0px);
</code></pre>

<p>のような視覚的には意味のない記述でも<br />
GPUでやってくれるのはトリックっぽくて好きだが、（pxはいらないかもしれない）<br />
正直ブラウザ側の最適化とかでやって欲しい気はしなくもない。<br />
使いすぎるとVRAMを喰うともあったから、そうブラウザで勝手にやるわけにもいかないのだろうか。</p>

<p>結果、最適化のおかげで初回入力遅延は20ms近くまで削減された。<br />
<img src="https://umio-yasuno.github.io/image/2019/11/25/pagespeed-result.webp" alt="PageSpeed Result" /></p>

<p>地味な所ではCSSのアニメーション部分を別ファイルに分けたり、CSSをpreloadするようにしたり、<br />
サイトタイトルがページ切替時、一瞬青色（リンクに指定した色）になったりするのを直接スタイル指定することで回避したりした。</p>

<p>最適化以外では、Tags と Categories を footer に追加した。<br />
一覧もある程度は整備してある。<br />
ただ Tags は量が多く、表示時に少しもたつくため、ページ分割した方がいいかもしれない。</p>

<p><del>もうほぼ完成したため、公開してもいいかもしれないが、<br />
やっぱり細かいところがめんどくさい。</del></p>

<p>ある程度整えてからGithubに公開してみた。<br />
<a href="https://github.com/Umio-Yasuno/crt-theme-hugo" rel="nofollow noreferrer" target="_blank">https://github.com/Umio-Yasuno/crt-theme-hugo</a><br />
公式への登録?は一切考えていない。<br />
そこまでのクオリティではないし、色々とハードルが高そう。</p>

<hr>
<div class="footer">
<a href="https://umio-yasuno.github.io/tags">Tags</a>:<a href="https://umio-yasuno.github.io/tags/hugo"> Hugo,</a><br>
			<a href="https://umio-yasuno.github.io/categories">Categories</a>:<a href="https://umio-yasuno.github.io/categories/diary"> Diary,</a><br> <span>&nbsp;&nbsp;Author : Umio Yasuno</span>
		&nbsp;/&nbsp;&nbsp;<span data-lastmod="Nov 25 2019, 08:18">Lastmod : Nov 25, 08:18</span>
		<br>
		<address class="mail"><a href="https://umio-yasuno.github.io/about/">About</a> </address>
		<br><br>	<span class="title">
		<a href="https://umio-yasuno.github.io/">Coelacanth&#39;s Dream</a>
	</span>
</div>

		</article>
	</main>
					<div class="lace"></div> 
    </body>
</html>

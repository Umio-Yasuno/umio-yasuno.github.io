<!DOCTYPE html>
<html lang="ja">
	<head>
		
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
    <meta name="referrer" content="no-referrer">
	<meta name="format-detection" content="telephone=no, address=no, email=no">
	<meta property="og:locale" content="ja">
	<base href="https://blog.coelacanth-dream.com/posts/2020/04/04/raven-dieshot-guess/"><title>Raven Ridgeのダイ観察 &amp; 推測 | Coelacanth&#39;s Dream</title>
	<meta property="og:title" content="Raven Ridgeのダイ観察 &amp; 推測 | Coelacanth&#39;s Dream">
	<meta name="twitter:title" content="Raven Ridgeのダイ観察 &amp; 推測 | Coelacanth&#39;s Dream">
	<meta name="og:type" content="article">

	<meta name="description" content="Zen &#43; Vega なAPU、Raven Ridge (以下 Raven) のダイ観察 &amp; ユニット推測。 画像出典は例の通りFritzchens Fritz | Flickr氏により撮影され、パブリック・ドメインで公開されているダイショット。">
	<meta property="og:description" content="Zen &#43; Vega なAPU、Raven Ridge (以下 Raven) のダイ観察 &amp; ユニット推測。 画像出典は例の通りFritzchens Fritz | Flickr氏により撮影され、パブリック・ドメインで公開されているダイショット。">
	<meta name="twitter:description" content="Zen &#43; Vega なAPU、Raven Ridge (以下 Raven) のダイ観察 &amp; ユニット推測。 画像出典は例の通りFritzchens Fritz | Flickr氏により撮影され、パブリック・ドメインで公開されているダイショット。">
	<meta property="og:image" content="https://blog.coelacanth-dream.com/image/site-image.png">
	<meta name="url" content="https://blog.coelacanth-dream.com/posts/2020/04/04/raven-dieshot-guess/">
	<meta name="author" content="Umio Yasuno">
	<meta name="keywords" content="Radeon, DieShot, ">

		<link rel="preload" href="https://blog.coelacanth-dream.com/css/footer.min.css" as="style">
		<link rel="preload" href="https://blog.coelacanth-dream.com/css/page.min.css" as="style">
<style>

html
	{	background-size: cover;
		background-attachment: fixed;
		background-image: radial-gradient(farthest-corner, #2A4747 88%, #172727 95%, #040707 100%);
		font-size: 1em;
}
main
	{	display: grid;
		grid-template: repeat(4, auto) / 1vw 1em auto 8vw;
		row-gap: 1em;
}
header
	{	grid-row: 2 / 3;
		grid-column: 1 / 4;
}
.title
	{	font: normal 1.6em monospace;
		text-decoration: none;
		text-align: end;
}
	.title a
		{	color: #6D9CA9;
			text-shadow: 0 2px .8em #577C87;
	}
	.title a:hover
		{	color: #98B9C2;
			text-decoration: none;
			text-shadow: 0 2px 1em #7EA0A9;
	}
.page-title, .page-title a
	{	color: #FFA319;
		font-size: 1em;
		line-height: 1.2em;
		margin: 0;
		padding: 0;
		max-width: 95%;
}
	.page-title a:hover,.sect-page a:hover
		{	text-decoration: underline #CC8214;
	}
.tag-title, .categorie-title
	{	color: #7FFFFF;
}
a
	{	color: #75D1FF;
		text-decoration: none;
		padding: 0 .28em 0 .25em;
		margin: 0;
		word-break: break-all;
}
	a:hover
		{	text-decoration: underline;
	}
.text
	{	color: snow;
		box-sizing: border-box;
		line-height: 1.6em;
		overflow-wrap: break-word;
		text-justify: inter-character;
		grid-area: 3 / 2 / 4 / 5;
		scrollbar-width: thin;
		scrollbar-color: rgba(0,128,128, .5) rgba(255,0,0, 0)
}
article > p::first-letter
	{	padding-left: .6em;
}
.copyright
	{	font-size: .9em;
		padding: 2em 1em 0 0;
		display: block;
}
.foot, .side
	{	display: none;
}
.foot
	{	grid-area: 4 / 1 / 5 / 5;
}
@media (min-width: 840px)
	{	main
			{	display: grid;
				grid-template: 2em 6em 2em auto / 2em 200px auto;
		}
		.text
			{	grid-area: 1 / 3 / 5 / 3;
				padding: 1em .5em 8% 1em;
		}
		header > .title
			{	display: none;
		}
		.side
			{	display: block;
					height: 96vh;
					width: 200px;
				position: fixed;
					top: 1em;
					left: 24px;
				padding-right: 1.2em;
				border-right: 1px solid green;
				font-size: 1em;
				color: #00E500;
				z-index: 101;
				transform: translateZ(0);

				overflow: scroll;
				scrollbar-width: thin;
				scrollbar-color: rgba(0,128,128, .5) rgba(255,0,0, 0)
		}
			.side > .title
				{	text-align: end;
					padding: 1em 0 0 0;
					width: 100%;
					font: normal 1.6em monospace;
			}
		.side-pagination
			{	display: grid;
				margin: 2em 0 2em 1em;
				font-size: 1.05em;
				row-gap: .8em;
				grid-template: repeat(3, 1fr) / 1em .9fr 2em;
		}
		.side-prev
			{	grid-area: 1 / 1 / 1 / 4;
				margin-right: auto;
				color: #9EDEFF;
		}
			.side-prev::before
				{	content: '\2190';
			}
		.side-next
			{	grid-area: 3 / 1 / 3 / 4;
				margin-left: auto;
				color: #9EDEFF;
		}
			.side-next::after
				{	content: '\2192';
					vertical-align: middle;
			}
		.side-page-number
			{	font-size: .9em;
				grid-area: 2 / 2 / 3 / 3;
				margin: 0 auto 0 auto;
		}
		.side-author, .side-lastmod, .side-about, .side-time
			{	padding: .5em 0 .5em 0;
				margin: 0;
				font-size: .95rem;
		}
		.side li::before
			{	color: #008080;
				content: '\25AA';
				padding: 0;
		}
		.side-links ul, .side-tags ul, .side-categories ul
			{	list-style: none none outside;
				padding: 0 0 0 1em;
				color: #7FFFD4;
				line-height: 1.5em;
		}
		.side-pagination
			{	display: grid;
				margin: 2em 0 2em 1em;
				font-size: 1.05em;
				row-gap: .8em;
				grid-template: repeat(3, 1fr) / 1em .9fr 2em;
		}
		.side-prev
			{	grid-area: 1 / 1 / 1 /4;
				margin-right: auto;
				color: #9EDEFF;
		}
			.side-prev::before
				{	content: '\2190';
			}
		.side-next
			{	grid-area: 3 / 1 / 3 / 4;
				margin-left: auto;
				color: #9EDEFF;
		}
			.side-next::after
				{	content: '\2192';
					vertical-align: middle;
			}
}
</style>

			<link rel="stylesheet" href="https://blog.coelacanth-dream.com/css/page.min.css">
			<link rel="preload" href="https://blog.coelacanth-dream.com/css/ins.min.css" as="style">
		<link rel="icon" href="https://blog.coelacanth-dream.com/favicon.ico">
	</head>
    <body>
	<main>
		<header><div class="title">
	<a href="https://blog.coelacanth-dream.com/">Coelacanth&#39;s Dream</a>
</div>
</header>
		<div class="text">
    		
<article>
	<header>
		<h1>Raven Ridgeのダイ観察 &amp; 推測</h1>
	</header>

<p><em>Zen</em> + <em>Vega</em> なAPU、<em>Raven Ridge (以下 Raven)</em> のダイ観察 &amp; ユニット推測。<br />
画像出典は例の通り<a href="https://www.flickr.com/photos/130561288@N04/" rel="noreferrer" target="_blank">Fritzchens Fritz | Flickr</a>氏により撮影され、パブリック・ドメインで公開されているダイショット。</p>

<p>それと今回、CSSだけで画像の一部分を拡大する方法を用いてみたが、頑張ってはみたものの、いかんせん調整が難しく、一部環境ではおかしく見える可能性があることをご容赦願いたい。</p>

<p><figure>
	<img src="https://blog.coelacanth-dream.com/image/2020/04/04/raven-dieshot.webp" alt="ダイサイズ: 208.84mm2画像出典: AMD@14nm@Zen(Zeppelin)@Raven_Ridge@Ryzen_3_2200G@YD2200C5M… | Flickr" >
	<figcaption>
		<h4>Raven 推測 <em>全体</em></h4>
		<p>ダイサイズ: 208.84mm<sup>2</sup><br>画像出典: <a href="https://www.flickr.com/photos/130561288@N04/39716562275" rel="noreferrer" target="_blank">AMD@14nm@Zen(Zeppelin)@Raven_Ridge@Ryzen_3_2200G@YD2200C5M… | Flickr</a></p>
	</figcaption>
</figure>

AMDの発表ではダイサイズが 209.78mm<sup>2</sup>だが、誤差の範囲だろう。<sup class="footnote-ref" id="fnref:1"><a href="#fn:1">1</a></sup><br />
GPUが統合されたことで機能は増えたが、<em>Zeppelin</em><sup class="footnote-ref" id="fnref:2"><a href="#fn:2">2</a></sup> が2CCX(8-Core)構成だったのに対し、<em>Raven</em> では1CCXとし、またCCXあたりのL3キャッシュを4MBに減らしている。<br />
Threadripper、EPYCの製品で活かされたパッケージ内の他ダイ接続用のインターフェイスも、PCI Expressと共用である他ソケットへの接続インターフェイスも排されたことで、<em>Raven</em> は <em>Zeppelin</em> のダイサイズ: 213mm<sup>2</sup>よりもほんのわずかに小さいダイとなっている。</p>

<p><figure>
	<img src="https://blog.coelacanth-dream.com/image/2020/04/04/raven-dieshot.webp" alt="画像出典: AMD@14nm@Zen(Zeppelin)@Raven_Ridge@Ryzen_3_2200G@YD2200C5M… | Flickr" style="width: 48vmax; height: 64vmax; object-position: 100% 16%; object-fit: cover">
	<figcaption>
		<h4>Raven 推測 <em>ダイ右側 ShaderEngine付近</em></h4>
		<p>画像出典: <a href="https://www.flickr.com/photos/130561288@N04/39716562275" rel="noreferrer" target="_blank">AMD@14nm@Zen(Zeppelin)@Raven_Ridge@Ryzen_3_2200G@YD2200C5M… | Flickr</a></p>
	</figcaption>
</figure>

GPUの規模は <a href="https://github.com/GPUOpen-Drivers/pal" rel="noreferrer" target="_blank">pal/ndDevice.cpp at dev · GPUOpen-Drivers/pal</a><sup class="footnote-ref" id="fnref:3"><a href="#fn:3">3</a></sup> によると、</p>

<ul>
<li>1-ShaderEngine</li>
<li>RBE(RenderBackend)数は2基</li>
<li>総CU数は11基</li>
<li>TCC(L2cache)ブロック数は4基(ブロックあたり256KB、計1MB)</li>
</ul>

<p>HotChips30での発表資料ではRBE数が4基であるように書かれているが<sup class="footnote-ref" id="fnref:4"><a href="#fn:4">4</a></sup>、後からいくらでも修正可能なソースコードが最新の状態で、<em>RBEは2基</em> 、とあるためそちらを信用する。<br />
ダイショットからこれとこれがRBE、と示せればいいのだが、<em>Raven</em> のようなSoCはダイサイズを抑えるため、内部のユニットが複雑に配置されており、はっきりと判別するのは難しかった。</p>

<p>L1 I$(32KB) /K$(16KB)は2CU、または3CUで共有する構成となっていた。CU 11基に対してL1 I$/K$ 4基ということから、共有するCU数の基本単位は3基だろう。<br />
この3基で共有、というのは <em>Vega10</em> 、 <em>Vega20</em> のダイショットからも見て取れた。<sup class="footnote-ref" id="fnref:5"><a href="#fn:5">5</a></sup><br />
<em>GFX9</em> で共通した設計部分なのだろうか。もしかしたら <em>Raven</em> よりもCPU、GPU、I/O、全体の規模を減らし、ダイをより小さくした <em>Raven2</em> のCU数が3基であることの要因かもしれない。</p>

<p><figure>
	<img src="https://blog.coelacanth-dream.com/image/2020/04/04/raven-dieshot.webp" alt="画像出典: AMD@14nm@Zen(Zeppelin)@Raven_Ridge@Ryzen_3_2200G@YD2200C5M… | Flickr" style="width: 48vmax; height: 32vmax; object-position: 64% 30%; object-fit: none">
	<figcaption>
		<h4>Raven 推測 <em>ダイ中央</em></h4>
		<p>画像出典: <a href="https://www.flickr.com/photos/130561288@N04/39716562275" rel="noreferrer" target="_blank">AMD@14nm@Zen(Zeppelin)@Raven_Ridge@Ryzen_3_2200G@YD2200C5M… | Flickr</a></p>
	</figcaption>
</figure>

ダイ中央に配置された4基のユニットだが、これはダイ内の各ユニットの接続に使われている <em>Infinity Fabric</em> の <em>Transport Layer Switch</em> と考えている。</p>

<p>最初は4基であることからディスプレイコントローラだと思っていたが、他のGPUのダイショットを見るに、それらしきユニットは画像のようにSRAMをそう多くは内包していない。<br />
HotChips30の発表資料に <em>Trasport Layer Switch</em> が4基存在するような図表があり、そういった高速なデータ通信に関連するユニットであれば、バッファだろうSRAMを多く含むのは自然なはずだ。</p>

<p><figure>
	<img src="https://blog.coelacanth-dream.com/image/2020/04/04/raven-dieshot.webp" alt="画像出典: AMD@14nm@Zen(Zeppelin)@Raven_Ridge@Ryzen_3_2200G@YD2200C5M… | Flickr" style="width: 100%; height: 12vmax; object-position: 40% 100%; object-fit: cover">
	<figcaption>
		<h4>Raven 推測 <em>ダイ下部 I/O</em></h4>
		<p>画像出典: <a href="https://www.flickr.com/photos/130561288@N04/39716562275" rel="noreferrer" target="_blank">AMD@14nm@Zen(Zeppelin)@Raven_Ridge@Ryzen_3_2200G@YD2200C5M… | Flickr</a></p>
	</figcaption>
</figure>

<a href="https://www.x.org/wiki/RadeonFeature/" rel="noreferrer" target="_blank">RadeonFeature</a>から、</p>

<ul>
<li>Display Controller数は4基(最大映像出力数: 4)</li>
</ul>

<p><em>Raven</em> ベースの製品である Ryzen Embedded V1000シリーズの仕様から、<sup class="footnote-ref" id="fnref:6"><a href="#fn:6">6</a></sup></p>

<ul>
<li>最大4つのUSB 3.1(10Gbps)</li>
<li>2つのUSB Type-C、DisplayPort出力とPower Deliveryに対応</li>
<li>最大2つのSATAポート</li>
<li>最大16レーンのPCIeGen3</li>
</ul>

<p>ということがわかっており、それを元にしている。<br />
左から、USB 3.1インターフェイス(以下I/F) 4基、ディスプレイI/F 2基とUSB Type-C I/F2基<sup class="footnote-ref" id="fnref:8"><a href="#fn:8">7</a></sup>、PCIeGen3 2-LaneとSATAの共用I/F 2基、ディスプレイI/F 2基、と推測した。<br />
USB Type-C I/Fの上にあるユニットが、他のGPUで見られるディスプレイコントローラの形状、構造に近いため、そうであると考えた。ディスプレイI/Fとの距離も近い。</p>

<p>USB Type-Cに関しては似た配置が <em>Navi10</em> 、<em>Navi14</em> でも見られる。<sup class="footnote-ref" id="fnref:7"><a href="#fn:7">8</a></sup></p>

<h2 id="余談">余談</h2>

<p>いつか <em>Raven2</em> と <em>Renoir</em> のダイショットも見てみたいが、自分はそのための技術を持ってないため、ひたすらに待つ。<br />
<em>Renoir</em> は総CU数が8基だが、GFX9系列であることを考えるとL1 I$/K$は3基だろうか。後は <em>Raven2</em> のRBE数が1基であることから、どれがRBEなのか特定したり、<em>Transport Layer Switch</em> の数は <em>Raven</em> と <em>Raven2</em> とで同じなのか、後は何と言ってもどのようにユニットを詰め込んでいるのかと、確かめてみたいことはたくさんある。</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1"><a href="https://www.hotchips.org/hc30/1conf/1.05_AMD_APU_AMD_Raven_HotChips30_Final.pdf#page=4" rel="noreferrer" target="_blank">Delivering a new level of Visual Performance in and SoC – AMD Raven Ridge APU</a>
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
<li id="fn:2">Ryzen /Threadripper 1000シリーズ、EPYC 7001シリーズに採用されているダイ。CPUアーキテクチャは <em>Zen</em> 、製造プロセスはGF14nm FinFet。
 <a class="footnote-return" href="#fnref:2"><sup>[return]</sup></a></li>
<li id="fn:3"><a href="https://github.com/GPUOpen-Drivers/pal/blob/dev/src/core/os/nullDevice/ndDevice.cpp#L888" rel="noreferrer" target="_blank">https://github.com/GPUOpen-Drivers/pal/blob/dev/src/core/os/nullDevice/ndDevice.cpp#L888</a>
 <a class="footnote-return" href="#fnref:3"><sup>[return]</sup></a></li>
<li id="fn:4"><a href="https://www.hotchips.org/hc30/1conf/1.05_AMD_APU_AMD_Raven_HotChips30_Final.pdf" rel="noreferrer" target="_blank">Delivering a new level of Visual Performance in and SoC – AMD Raven Ridge APU</a><br>&emsp;&emsp;<a href="https://www.hotchips.org/hc30/1conf/1.05_AMD_APU_AMD_Raven_HotChips30_Final.pdf#page=5" rel="noreferrer" target="_blank">https://www.hotchips.org/hc30/1conf/1.05_AMD_APU_AMD_Raven_HotChips30_Final.pdf#page=5</a>
 <a class="footnote-return" href="#fnref:4"><sup>[return]</sup></a></li>
<li id="fn:5"><a href="https://blog.coelacanth-dream.com/posts/2020/03/24/vega10-vega20-dieshot-guess/">Vega10/Vega20のダイ観察 &amp; 推測 | Coelacanth&rsquo;s Dream</a>
 <a class="footnote-return" href="#fnref:5"><sup>[return]</sup></a></li>
<li id="fn:6"><a href="https://www.amd.com/system/files/documents/v1000-family-product-brief.pdf" rel="noreferrer" target="_blank">https://www.amd.com/system/files/documents/v1000-family-product-brief.pdf</a>
 <a class="footnote-return" href="#fnref:6"><sup>[return]</sup></a></li>
<li id="fn:8"><a href="https://www.hotchips.org/hc30/1conf/1.05_AMD_APU_AMD_Raven_HotChips30_Final.pdf#page=15" rel="noreferrer" target="_blank">https://www.hotchips.org/hc30/1conf/1.05_AMD_APU_AMD_Raven_HotChips30_Final.pdf#page=15</a>
 <a class="footnote-return" href="#fnref:8"><sup>[return]</sup></a></li>
<li id="fn:7"><a href="https://blog.coelacanth-dream.com/posts/2020/01/22/navi10-dieshot-and-guess/">Navi10のダイ観察 &amp; 推測 | Coelacanth&rsquo;s Dream</a><br>&emsp;<a href="https://blog.coelacanth-dream.com/posts/2020/01/26/navi14-dieshot-and-guess/">Navi14のダイ観察 &amp; 推測 | Coelacanth&rsquo;s Dream</a>
 <a class="footnote-return" href="#fnref:7"><sup>[return]</sup></a></li>
</ol>
</div>
</article>
		</div>
			<div class="side">
	<div class="title">
	<a href="https://blog.coelacanth-dream.com/">Coelacanth&#39;s Dream</a>
</div>

	<nav class="side-links">
	<ul>
		<li><a href="https://blog.coelacanth-dream.com/posts">Posts</a></li><li><a href="https://blog.coelacanth-dream.com/tags/database">Database</a></li>
	</ul>
	</nav><nav class="side-tags">
		<ul>
			<li><a href="https://blog.coelacanth-dream.com/tags" class="tag-title">Tags</a>:</li>
			<ul>
			<li><a href="https://blog.coelacanth-dream.com/tags/radeon">Radeon</a></li>
			<li><a href="https://blog.coelacanth-dream.com/tags/dieshot">DieShot</a></li>
			</ul>
		</ul>
		</nav>
		<nav class="side-categories">
		<ul>
			<li><a href="https://blog.coelacanth-dream.com/categories" class="categorie-title">Categories</a>:</li>
			<ul>
			<li><a href="https://blog.coelacanth-dream.com/categories/hardware">Hardware</a></li>
			<li><a href="https://blog.coelacanth-dream.com/categories/amd">AMD</a></li>
			<li><a href="https://blog.coelacanth-dream.com/categories/apu">APU</a></li>
			</ul>
		</ul>
		</nav>
	<div class="side-author">Author : Umio Yasuno</div><time datetime="2020-04-04 " class="side-time">Post : 2020-04-04 </time>
		<div class="side-lastmod">Lastmod :<br>&nbsp;&nbsp;2020-04-04 23:18:41 </div><nav class="side-about">
		<a href="https://blog.coelacanth-dream.com/about/">About</a>
		<a href="https://blog.coelacanth-dream.com/about/#donate">Donate</a>
	</nav>
		<small class="copyright">Copyright &copy; 2019 - 2020 Umio Yasuno</small>
</div>

			<link rel="stylesheet" href="https://blog.coelacanth-dream.com/css/footer.min.css">
			<div class="foot">
	<hr>
	<footer>
		<nav class="foot-tags">
			<a href="https://blog.coelacanth-dream.com/tags" class="tag-title">Tags :</a>
			<a href="https://blog.coelacanth-dream.com/tags/radeon">Radeon</a>,&nbsp;
			<a href="https://blog.coelacanth-dream.com/tags/dieshot">DieShot</a>,&nbsp;
		</nav>
		<nav class="foot-categories">
			<a href="https://blog.coelacanth-dream.com/categories" class="categorie-title">Categories :</a>
			<a href="https://blog.coelacanth-dream.com/categories/hardware">Hardware</a>,&nbsp;
			<a href="https://blog.coelacanth-dream.com/categories/amd">AMD</a>,&nbsp;
			<a href="https://blog.coelacanth-dream.com/categories/apu">APU</a>,&nbsp;
		</nav>
			<a href="https://blog.coelacanth-dream.com/posts">Posts</a>
			<a href="https://blog.coelacanth-dream.com/tags/database">Database</a><br><br><time datetime="2020-04-04 06:11:26 " class="foot-time">Post : 2020-04-04</time>
		/ <span class="foot-lastmod">Lastmod : 2020-04-04 23:18:41 </span><div class="foot-author">Author : Umio Yasuno</div><nav>
		<a href="https://blog.coelacanth-dream.com/about/">About</a>
		<a href="https://blog.coelacanth-dream.com/about/#donate">Donate</a>
	</nav>
		<small class="copyright">Copyright &copy; 2019 - 2020 Umio Yasuno</small>
	</footer>
</div>
</main>
    </body>
</html>
